---
title: 1075. 项目员工 I
date: 2024-05-04 06:00:00 +0800
categories: [Daily Coding, Top SQL 50, 聚合函数]
tags: [聚合函数]
toc: true
math: true
pin: false
render_with_liquid: false
image:
  path: https://cdn.jsdelivr.net/gh/Zong-Liang/blog_images/blog/2024/daily_coding/20251121163556362.png
  lqip: data:image/webp;base64,UklGRpoAAABXRUJQVlA4WAoAAAAQAAAADwAABwAAQUxQSDIAAAARL0AmbZurmr57yyIiqE8oiG0bejIYEQTgqiDA9vqnsUSI6H+oAERp2HZ65qP/VIAWAFZQOCBCAAAA8AEAnQEqEAAIAAVAfCWkAALp8sF8rgRgAP7o9FDvMCkMde9PK7euH5M1m6VWoDXf2FkP3BqV0ZYbO6NA/VFIAAAA
---

## 题目：1075. 项目员工 I

**项目表 `Project`:**

| Column Name | Type |
| ----------- | ---- |
| project_id  | int  |
| employee_id | int  |

- 主键为 `(project_id, employee_id)`。
- `employee_id` 是员工表 `Employee` 表的外键。
- 这张表的每一行表示 `employee_id` 的员工正在 `project_id` 的项目上工作。

**员工表 `Employee`:**

| Column Name      | Type    |
| ---------------- | ------- |
| employee_id      | int     |
| name             | varchar |
| experience_years | int     |

- 主键是 `employee_id`。数据保证 `experience_years` 非空。
- 这张表的每一行包含一个员工的信息。

**问题描述:**

请写一个 SQL 语句，查询每一个项目中员工的 **平均** 工作年限，**精确到小数点后两位**。

以 **任意顺序** 返回结果表。

**示例 1:**

**输入:**

`Project` 表:

| project_id | employee_id |
| ---------- | ----------- |
| 1          | 1           |
| 1          | 2           |
| 1          | 3           |
| 2          | 1           |
| 2          | 4           |

`Employee` 表:

| employee_id | name   | experience_years |
| ----------- | ------ | ---------------- |
| 1           | Khaled | 3                |
| 2           | Ali    | 2                |
| 3           | John   | 1                |
| 4           | Doe    | 2                |

**输出:**

| project_id | average_years |
| ---------- | ------------- |
| 1          | 2.00          |
| 2          | 2.50          |

**解释:**

第一个项目中，员工的平均工作年限是 (3 + 2 + 1) / 3 = 2.00; 第二个项目中，员工的平均工作年限是 (3 + 2) / 2 = 2.50。

## 题解

你需要将 `Project` 表和 `Employee` 表连接起来，然后按 `project_id` 分组，并计算每个组的 `experience_years` 的平均值。

```sql
SELECT p.project_id,
       ROUND(AVG(e.experience_years), 2) AS average_years
FROM Project p
         JOIN
     Employee e ON p.employee_id = e.employee_id
GROUP BY p.project_id;
```

**查询逻辑分解:**

1. **`FROM Project p JOIN Employee e ON p.employee_id = e.employee_id`**:

   - 我们使用 `JOIN` 将 `Project` 表 (别名为 `p`) 和 `Employee` 表 (别名为 `e`) 连接起来。
   - 连接条件 `ON p.employee_id = e.employee_id` 将每个项目中的员工 ID 与员工表中的详细信息（特别是 `experience_years`）匹配起来。

2. **`GROUP BY p.project_id`**:

   - 按 `project_id` 对连接后的结果进行分组。这会把所有参与同一个项目的员工数据放在一组，以便我们为每个项目计算平均值。

3. **`SELECT p.project_id, ROUND(AVG(e.experience_years), 2) AS average_years`**:

   - `p.project_id`: 选择项目 ID。
   - `AVG(e.experience_years)`: 使用 `AVG()` 聚合函数计算每个项目分组中所有员工的 `experience_years` 的平均值。
   - `ROUND(..., 2)`: 使用 `ROUND()` 函数将计算出的平均值四舍五入到小数点后两位。
   - `AS average_years`: 将结果列重命名为 `average_years`。
