---
title: 0584. 寻找用户推荐人
date: 2024-04-03 06:00:00 +0800
categories: [Daily Coding, Top SQL 50, 查询]
tags: [查询]
toc: true
math: true
pin: false
render_with_liquid: false
image:
  path: https://cdn.jsdelivr.net/gh/Zong-Liang/blog_images/blog/2024/daily_coding/20251121153600971.png
  lqip: data:image/webp;base64,UklGRpoAAABXRUJQVlA4WAoAAAAQAAAADwAABwAAQUxQSDIAAAARL0AmbZurmr57yyIiqE8oiG0bejIYEQTgqiDA9vqnsUSI6H+oAERp2HZ65qP/VIAWAFZQOCBCAAAA8AEAnQEqEAAIAAVAfCWkAALp8sF8rgRgAP7o9FDvMCkMde9PK7euH5M1m6VWoDXf2FkP3BqV0ZYbO6NA/VFIAAAA
---

## 题目：0584. 寻找用户推荐人

**表:** `Customer`

| Column Name | Type    |
| ----------- | ------- |
| id          | int     |
| name        | varchar |
| referee_id  | int     |

- 在 SQL 中, `id` 是该表的主键列。
- 该表的每一行表示一个客户的 `id`、姓名以及推荐他们的客户的 `id`。

**问题描述:**

找出以下客户的姓名：

1. 被任何 `id != 2` 的用户推荐。
2. 没有被任何用户推荐。

以 **任意顺序** 返回结果表。

**示例 1:**

**输入:**

`Customer` 表:

| id  | name | referee_id |
| --- | ---- | ---------- |
| 1   | Will | null       |
| 2   | Jane | null       |
| 3   | Alex | 2          |
| 4   | Bill | null       |
| 5   | Zack | 1          |
| 6   | Mark | 2          |

**输出:**

| name |
| ---- |
| Will |
| Jane |
| Bill |
| Zack |

## 题解

你需要筛选出 `referee_id` 不等于 2 或 `referee_id` 为 `NULL` 的客户。在 SQL 中处理 `NULL` 值时需要特别注意。

```sql
SELECT name
FROM Customer
WHERE referee_id != 2 OR referee_id IS NULL;
```

**查询逻辑分解:**

1. **`SELECT name`**:

   - 我们的目标是找出符合条件的客户的姓名。

2. **`FROM Customer`**:

   - 指定从 `Customer` 表中查询数据。

3. **`WHERE referee_id != 2 OR referee_id IS NULL`**:

   - 这是筛选条件的核心，它由两个通过 `OR` 连接的部分组成。
   - `referee_id != 2`: 这个条件会筛选出所有被 `id` 不为 2 的客户推荐的用户。**重要提示：** 在标准的 SQL 中，当
     `referee_id` 为 `NULL` 时，`referee_id != 2` 的结果是 `UNKNOWN`，这在 `WHERE` 子句中被视为 `FALSE`
     。因此，仅有这个条件会漏掉没有推荐人的客户。
   - `referee_id IS NULL`: 这个条件明确地筛选出那些没有推荐人的客户（`referee_id` 字段为 `NULL`）。
   - 使用 `OR` 将这两个条件结合起来，就能完整地找出所有“没有被 id = 2 的用户推荐”以及“没有被任何用户推荐”的客户。
