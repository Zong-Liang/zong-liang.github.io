---
title: 1068. 产品销售分析 I
date: 2024-04-18 06:00:00 +0800
categories: [Daily Coding, Top SQL 50, 连接]
tags: [连接]
toc: true
math: true
pin: false
render_with_liquid: false
image:
  path: https://cdn.jsdelivr.net/gh/Zong-Liang/blog_images/blog/2024/daily_coding/20251121161805395.png
  lqip: data:image/webp;base64,UklGRpoAAABXRUJQVlA4WAoAAAAQAAAADwAABwAAQUxQSDIAAAARL0AmbZurmr57yyIiqE8oiG0bejIYEQTgqiDA9vqnsUSI6H+oAERp2HZ65qP/VIAWAFZQOCBCAAAA8AEAnQEqEAAIAAVAfCWkAALp8sF8rgRgAP7o9FDvMCkMde9PK7euH5M1m6VWoDXf2FkP3BqV0ZYbO6NA/VFIAAAA
---

## 题目：1068. 产品销售分析 I

**销售表 `Sales`:**

| Column Name | Type |
| ----------- | ---- |
| sale_id     | int  |
| product_id  | int  |
| year        | int  |
| quantity    | int  |
| price       | int  |

- `(sale_id, year)` 是销售表 `Sales` 的主键。
- `product_id` 是关联到产品表 `Product` 的外键。
- 该表的每一行显示 `product_id` 在某一年的一些销售情况。
- 注意: `price` 表示每单位价格。

**产品表 `Product`:**

| Column Name  | Type    |
| ------------ | ------- |
| product_id   | int     |
| product_name | varchar |

- `product_id` 是表的主键。
- 该表的每一行表示每种产品的产品名称。

**问题描述:**

编写解决方案，以获取 `Sales` 表中所有 `sale_id` 对应的 `product_name` 以及该产品的所有 `year` 和 `price`。

返回结果表 **无顺序要求**。

**示例 1:**

**输入:**

`Sales` 表:

| sale_id | product_id | year | quantity | price |
| ------- | ---------- | ---- | -------- | ----- |
| 1       | 100        | 2008 | 10       | 5000  |
| 2       | 100        | 2009 | 12       | 5000  |
| 7       | 200        | 2011 | 15       | 9000  |

`Product` 表:

| product_id | product_name |
| ---------- | ------------ |
| 100        | Nokia        |
| 200        | Apple        |
| 300        | Samsung      |

**输出:**

| product_name | year | price |
| ------------ | ---- | ----- |
| Nokia        | 2008 | 5000  |
| Nokia        | 2009 | 5000  |
| Apple        | 2011 | 9000  |

## 正确答案 (MySQL)

你需要将 `Sales` 表和 `Product` 表连接起来，以通过 `product_id` 获取每个销售记录对应的产品名称。

```sql
SELECT Product.product_name,
       Sales.year,
       Sales.price
FROM Product,
     Sales
WHERE Product.product_id = Sales.product_id 

-- OR

SELECT p.product_name,
       s.year,
       s.price
FROM Sales s
JOIN  Product p ON s.product_id = p.product_id;
```

**查询逻辑分解:**

1. **`FROM Sales s JOIN Product p ON s.product_id = p.product_id`**:

   - 我们使用 `JOIN`（默认为 `INNER JOIN`）将 `Sales` 表 (别名为 `s`) 和 `Product` 表 (别名为 `p`) 连接起来。
   - 连接条件 `ON s.product_id = p.product_id` 指定了两个表之间通过 `product_id` 列进行关联。这样，对于 `Sales`
     表中的每一条销售记录，我们都能找到 `Product` 表中对应的产品信息。

2. **`SELECT p.product_name, s.year, s.price`**:

   - 从连接后的结果中，我们选择所需的列：

     - `p.product_name`：来自 `Product` 表的产品名称。
     - `s.year`：来自 `Sales` 表的销售年份。
     - `s.price`：来自 `Sales` 表的销售价格。
