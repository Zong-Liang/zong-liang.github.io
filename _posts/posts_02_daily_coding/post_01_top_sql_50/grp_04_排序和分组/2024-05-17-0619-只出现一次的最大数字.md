---
title: 0619. 只出现一次的最大数字
date: 2024-05-17 06:00:00 +0800
categories: [Daily Coding, Top SQL 50, 排序和分组]
tags: [排序和分组]
toc: true
math: true
pin: false
render_with_liquid: false
image:
  path: https://cdn.jsdelivr.net/gh/Zong-Liang/blog_images/blog/2024/daily_coding/20251121164514374.png
  lqip: data:image/webp;base64,UklGRpoAAABXRUJQVlA4WAoAAAAQAAAADwAABwAAQUxQSDIAAAARL0AmbZurmr57yyIiqE8oiG0bejIYEQTgqiDA9vqnsUSI6H+oAERp2HZ65qP/VIAWAFZQOCBCAAAA8AEAnQEqEAAIAAVAfCWkAALp8sF8rgRgAP7o9FDvMCkMde9PK7euH5M1m6VWoDXf2FkP3BqV0ZYbO6NA/VFIAAAA
---

## 题目：0619. 只出现一次的最大数字

**表:** `MyNumbers`

| Column Name | Type |
| ----------- | ---- |
| num         | int  |

- 该表可能包含重复项（换句话说，在 SQL 中，该表没有主键）。
- 这张表的每一行都含有一个整数。

**问题描述:**

**单一数字** 是在 `MyNumbers` 表中只出现一次的数字。

找出最大的 **单一数字**。如果不存在 **单一数字**，则返回 `null`。


**示例 1:**

**输入:**
`MyNumbers` 表:

| num |
| --- |
| 8   |
| 8   |
| 3   |
| 3   |
| 1   |
| 4   |
| 5   |
| 6   |

**输出:**

| num |
| --- |
| 6   |

**解释:** 单一数字有 1、4、5 和 6 。6 是最大的单一数字，返回 6 。

**示例 2:**

**输入:**
`MyNumbers` table:

| num |
| --- |
| 8   |
| 8   |
| 7   |
| 7   |
| 3   |
| 3   |

**输出:**

| num  |
| ---- |
| null |

**解释:** 输入的表中不存在单一数字，所以返回 null 。


## 正确答案 (MySQL)

你可以使用一个子查询来首先找出所有只出现一次的数字，然后在主查询中找到这些数字中的最大值。

```sql
SELECT MAX(num) AS num
FROM (SELECT num
      FROM MyNumbers
      GROUP BY num
      HAVING COUNT(num) = 1) AS single_numbers;
```

**查询逻辑分解:**

1. **子查询 `(SELECT ... ) AS single_numbers`**:

   - `SELECT num FROM MyNumbers`: 从 `MyNumbers` 表中选择 `num` 列。
   - `GROUP BY num`: 按 `num` 的值进行分组，将所有相同的数字分到同一组。
   - `HAVING COUNT(num) = 1`: 对分组后的结果进行筛选，只保留那些计数为 1 的组，这些就是 "单一数字"。
   - 这个子查询的结果是一个包含所有只出现过一次的数字的临时表 `single_numbers`。

2. **主查询 `SELECT MAX(num) AS num FROM ...`**:
   - `FROM single_numbers`: 从上面创建的只包含单一数字的临时表中查询。
   - `MAX(num)`: 使用 `MAX()` 聚合函数找出这个临时表中的最大值。
   - 如果子查询没有返回任何行（即没有单一数字），`MAX()` 函数将自然地返回 `NULL`，这正好满足了题目的要求。
