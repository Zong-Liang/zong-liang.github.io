---
title: 2356. 每位教师所教授的科目种类的数量
date: 2024-05-30 06:00:00 +0800
categories: [Daily Coding, Top SQL 50, 排序和分组]
tags: [排序和分组]
toc: true
math: true
pin: false
render_with_liquid: false
image:
  path: https://cdn.jsdelivr.net/gh/Zong-Liang/blog_images/blog/2024/daily_coding/20251121164926043.png
  lqip: data:image/webp;base64,UklGRpoAAABXRUJQVlA4WAoAAAAQAAAADwAABwAAQUxQSDIAAAARL0AmbZurmr57yyIiqE8oiG0bejIYEQTgqiDA9vqnsUSI6H+oAERp2HZ65qP/VIAWAFZQOCBCAAAA8AEAnQEqEAAIAAVAfCWkAALp8sF8rgRgAP7o9FDvMCkMde9PK7euH5M1m6VWoDXf2FkP3BqV0ZYbO6NA/VFIAAAA
---

## 题目：2356. 每位教师所教授的科目种类的数量

**表:** `Teacher`

| Column Name | Type |
| ----------- | ---- |
| teacher_id  | int  |
| subject_id  | int  |
| dept_id     | int  |

- 在 SQL 中, `(subject_id, dept_id)` 是该表的主键。
- 该表中的每一行都表示带有 `teacher_id` 的教师在系 `dept_id` 中教授科目 `subject_id`。

**问题描述:**

查询每位老师在大学里教授的科目种类的数量。

以 **任意顺序** 返回结果表。


**示例 1:**

**输入:**
`Teacher` 表:

| teacher_id | subject_id | dept_id |
| ---------- | ---------- | ------- |
| 1          | 2          | 3       |
| 1          | 2          | 4       |
| 1          | 3          | 3       |
| 2          | 1          | 1       |
| 2          | 2          | 1       |
| 2          | 3          | 1       |
| 2          | 4          | 1       |

**输出:**

| teacher_id | cnt |
| ---------- | --- |
| 1          | 2   |
| 2          | 4   |

**解释:**

- **教师 1:**
  - 他在 3、4 系教科目 2。
  - 他在 3 系教科目 3。
  - 总共教了科目 2 和 3，共 2 种。
- **教师 2:**
  - 他在 1 系教科目 1。
  - 他在 1 系教科目 2。
  - 他在 1 系教科目 3。
  - 他在 1 系教科目 4。
  - 总共教了科目 1, 2, 3, 4，共 4 种。


## 正确答案 (MySQL)

您可以使用 `GROUP BY` 按教师 ID 进行分组，并使用 `COUNT(DISTINCT ...)` 来计算每个教师教授的唯一科目数量。

```sql
SELECT teacher_id,
       COUNT(DISTINCT subject_id) AS cnt
FROM Teacher
GROUP BY teacher_id;
```

**查询逻辑分解:**

1. **`SELECT teacher_id, COUNT(DISTINCT subject_id) AS cnt`**:

   - `teacher_id`: 选择教师的 ID。
   - `COUNT(DISTINCT subject_id)`: 这是查询的核心。它计算每个分组中 **不重复的** `subject_id` 的数量。`DISTINCT`
     关键字确保了即使一个老师在不同系教同一门课，这门课也只被计算一次。
   - `AS cnt`: 将计数结果的列重命名为 `cnt`。

2. **`FROM Teacher`**:

   - 指定要查询的表是 `Teacher`。

3. **`GROUP BY teacher_id`**:
   - 将 `Teacher` 表中具有相同 `teacher_id` 的所有行组合成一个单独的组。聚合函数 `COUNT` 将在每个这样的分组上独立操作。
