---
title: 6. Z字形变换
date: 2024-04-09 06:00:00 +0800
categories: [Daily Coding, Top Interview 150, 数组_字符串]
tags: [数组_字符串]
toc: true
math: true
pin: false
render_with_liquid: false
image:
  path: https://cdn.jsdelivr.net/gh/Zong-Liang/blog_images/blog/2024/daily_coding/20251121223440271.png
  lqip: data:image/webp;base64,UklGRpoAAABXRUJQVlA4WAoAAAAQAAAADwAABwAAQUxQSDIAAAARL0AmbZurmr57yyIiqE8oiG0bejIYEQTgqiDA9vqnsUSI6H+oAERp2HZ65qP/VIAWAFZQOCBCAAAA8AEAnQEqEAAIAAVAfCWkAALp8sF8rgRgAP7o9FDvMCkMde9PK7euH5M1m6VWoDXf2FkP3BqV0ZYbO6NA/VFIAAAA
---

## 题目

**描述：**

将一个给定字符串 `s` 根据给定的行数 `numRows` ，以从上往下、从左到右进行 Z 字形排列。

比如输入字符串为 `"PAYPALISHIRING"` 行数为 3 时，排列如下：

```
P   A   H   N
A P L S I I G
Y   I   R
```

之后，你的输出需要从左往右逐行读取，产生出一个新的字符串，比如：`"PAHNAPLSIIGYIR"`。

请你实现这个将字符串进行指定行数变换的函数：
`string convert(string s, int numRows);`

**示例 1:**

- **输入:** `s = "PAYPALISHIRING"`, `numRows = 3`
- **输出:** `"PAHNAPLSIIGYIR"`

**示例 2:**

- **输入:** `s = "PAYPALISHIRING"`, `numRows = 4`
- **输出:** `"PINALSIGYAHRPIR"`
- **解释:**
  ```
  P     I    N
  A   L S  I G
  Y A   H R
  P     I
  ```

**示例 3:**

- **输入:** `s = "A"`, `numRows = 1`
- **输出:** `"A"`

**提示:**

- `1 <= s.length <= 1000`
- `s` 由英文字母（小写和大写）、`,` 和 `.` 组成
- `1 <= numRows <= 1000`

## 题解

### 解法：按行模拟

**思路：**

这道题其实不需要通过复杂的数学公式去计算每个字符在矩阵中的具体坐标。我们只需要模拟这个“Z”字形填写的轨迹即可。

1.  **容器准备**：我们可以创建 `numRows` 个 `StringBuilder`，分别代表 Z 字形的每一行。
2.  **模拟遍历**：遍历字符串 `s` 中的每个字符，将其添加到当前行（`currentRow`）的 `StringBuilder` 中。
3.  **方向控制**：我们需要一个变量来控制移动方向（向下或向上）。

    - 当我们移动到**第一行**（`0`）时，方向改为**向下**。
    - 当我们移动到**最后一行**（`numRows - 1`）时，方向改为**向上**。

4.  **合并结果**：遍历完成后，将所有行的 `StringBuilder` 按顺序拼接起来，就是最终结果。

**注意**：如果 `numRows` 为 1，由于无法上下移动，直接返回原字符串即可。

**复杂度分析：**

- **时间复杂度：** $O(n)$，其中 $n$ 是字符串 `s` 的长度。我们需要遍历整个字符串一次，然后拼接所有行也需要 $O(n)$。
- **空间复杂度：** $O(n)$，需要创建存储每一行字符的列表，总字符数等于 $n$。

**代码片段：**

```java
public String convert(String s, int numRows) {
    if (numRows < 2) return s;

    // 初始化每一行的 StringBuilder
    List<StringBuilder> rows = new ArrayList<>();
    for (int i = 0; i < numRows; i++) {
        rows.add(new StringBuilder());
    }

    int i = 0;
    int flag = -1; // 控制方向，-1 为向上，1 为向下

    for (char c : s.toCharArray()) {
        rows.get(i).append(c);
        // 到达第一行或最后一行时，反转方向
        if (i == 0 || i == numRows - 1) {
            flag = -flag;
        }
        i += flag;
    }

    // 拼接所有行
    StringBuilder res = new StringBuilder();
    for (StringBuilder row : rows) {
        res.append(row);
    }
    return res.toString();
}
```

### 完整代码

```java
import java.util.ArrayList;
import java.util.List;

public class Main {

    // 核心算法实现
    public static String convert(String s, int numRows) {
        // 如果只有一行，或者行数不少于字符长度，直接返回原字符串
        if (numRows < 2) {
            return s;
        }

        // 创建 numRows 个 StringBuilder，模拟每一行
        List<StringBuilder> rows = new ArrayList<>();
        for (int i = 0; i < numRows; i++) {
            rows.add(new StringBuilder());
        }

        int i = 0;
        int flag = -1; // 初始设为 -1，遇到第一行反转为 1（向下）

        for (char c : s.toCharArray()) {
            rows.get(i).append(c);

            // 如果到达顶部或底部，反转方向
            // i == 0: 刚开始或回到顶部，flag 变 1，向下走
            // i == numRows - 1: 到达底部，flag 变 -1，向上走
            if (i == 0 || i == numRows - 1) {
                flag = -flag;
            }

            // 更新当前行号
            i += flag;
        }

        // 将每一行的结果拼接起来
        StringBuilder res = new StringBuilder();
        for (StringBuilder row : rows) {
            res.append(row);
        }

        return res.toString();
    }

    public static void main(String[] args) {
        // --- 示例 1 ---
        String s1 = "PAYPALISHIRING";
        int numRows1 = 3;

        System.out.println("示例 1 输入: s = \"" + s1 + "\", numRows = " + numRows1);
        System.out.println("示例 1 输出: \"" + convert(s1, numRows1) + "\"");
        // 预期输出: "PAHNAPLSIIGYIR"
        System.out.println("-----------------------------");

        // --- 示例 2 ---
        String s2 = "PAYPALISHIRING";
        int numRows2 = 4;

        System.out.println("示例 2 输入: s = \"" + s2 + "\", numRows = " + numRows2);
        System.out.println("示例 2 输出: \"" + convert(s2, numRows2) + "\"");
        // 预期输出: "PINALSIGYAHRPIR"
        System.out.println("-----------------------------");

        // --- 示例 3 ---
        String s3 = "A";
        int numRows3 = 1;

        System.out.println("示例 3 输入: s = \"" + s3 + "\", numRows = " + numRows3);
        System.out.println("示例 3 输出: \"" + convert(s3, numRows3) + "\"");
        // 预期输出: "A"
    }
}
```
