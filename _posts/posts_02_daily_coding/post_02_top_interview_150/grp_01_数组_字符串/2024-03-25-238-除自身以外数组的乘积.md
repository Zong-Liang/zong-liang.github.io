---
title: 238. 除自身以外数组的乘积
date: 2024-03-25 06:00:00 +0800
categories: [Daily Coding, Top Interview 150, 数组_字符串]
tags: [数组_字符串]
toc: true
math: true
pin: false
render_with_liquid: false
image:
  path: https://cdn.jsdelivr.net/gh/Zong-Liang/blog_images/blog/2024/daily_coding/20251121222720953.png
  lqip: data:image/webp;base64,UklGRpoAAABXRUJQVlA4WAoAAAAQAAAADwAABwAAQUxQSDIAAAARL0AmbZurmr57yyIiqE8oiG0bejIYEQTgqiDA9vqnsUSI6H+oAERp2HZ65qP/VIAWAFZQOCBCAAAA8AEAnQEqEAAIAAVAfCWkAALp8sF8rgRgAP7o9FDvMCkMde9PK7euH5M1m6VWoDXf2FkP3BqV0ZYbO6NA/VFIAAAA
---

## 题目：238. 除自身以外数组的乘积

**描述**

给你一个整数数组 `nums`，返回 数组 `answer` ，其中 `answer[i]` 等于 `nums` 中除 `nums[i]` 之外其余各元素的乘积。

题目数据 **保证** 数组 `nums`之中任意元素的全部前缀元素和后缀的乘积都在 **32 位** 整数范围内。

请 **不要使用除法**，且在 `O(n)` 时间复杂度内完成此题。

**示例 1:**

- **输入:** `nums = [1,2,3,4]`
- **输出:** `[24,12,8,6]`

**示例 2:**

- **输入:** `nums = [-1,1,0,-3,3]`
- **输出:** `[0,0,9,0,0]`

**提示:**

- `2 <= nums.length <= 10^5`
- `-30 <= nums[i] <= 30`
- 输入 **保证** 数组 `answer[i]` 在 **32 位** 整数范围内

**进阶：** 你可以在 `O(1)` 的额外空间复杂度内完成这个题目吗？（出于对空间复杂度分析的目的，输出数组 **不被视为** 额外空间。）

## 题解

```java
import java.util.Arrays;

public class Main {

    /**
     * 计算除自身以外数组的乘积。
     * 采用左右乘积列表的方法，空间复杂度 O(1) (不考虑输出数组)。
     *
     * @param nums 整数数组
     * @return 结果数组
     */
    public static int[] productExceptSelf(int[] nums) {
        int n = nums.length;
        int[] answer = new int[n];

        // 1. 计算左侧所有元素的乘积
        // answer[i] 先用来存储 nums[i] 左侧所有元素的乘积
        // 对于 answer[0]，其左侧没有元素，所以为 1
        answer[0] = 1;
        for (int i = 1; i < n; i++) {
            answer[i] = nums[i - 1] * answer[i - 1];
        }

        // 2. 计算右侧所有元素的乘积，并与左侧乘积相乘
        // R 用于存储右侧所有元素的乘积，初始化为 1
        int R = 1;
        // 从右向左遍历
        for (int i = n - 1; i >= 0; i--) {
            // 对于索引 i，此时 answer[i] 存储的是其左侧所有元素的乘积
            // 再乘以右侧所有元素的乘积 R，就得到了最终结果
            answer[i] = answer[i] * R;
            // 更新 R，为下一次迭代做准备
            R *= nums[i];
        }

        return answer;
    }

    public static void main(String[] args) {
        // 示例 1
        int[] nums1 = {1, 2, 3, 4};
        System.out.println("输入: " + Arrays.toString(nums1));
        int[] result1 = productExceptSelf(nums1);
        System.out.println("输出: " + Arrays.toString(result1)); // 预期: [24, 12, 8, 6]
        System.out.println("---");

        // 示例 2
        int[] nums2 = {-1, 1, 0, -3, 3};
        System.out.println("输入: " + Arrays.toString(nums2));
        int[] result2 = productExceptSelf(nums2);
        System.out.println("输出: " + Arrays.toString(result2)); // 预期: [0, 0, 9, 0, 0]
        System.out.println("---");
    }
}
```
