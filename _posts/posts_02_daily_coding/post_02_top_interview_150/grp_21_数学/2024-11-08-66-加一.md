---
title: 66. 加一
date: 2024-11-08 06:00:00 +0800
categories: [Daily Coding, Top Interview 150, 数学]
tags: [数学]
toc: true
math: true
pin: false
render_with_liquid: false
image:
  path: https://cdn.jsdelivr.net/gh/Zong-Liang/blog_images/blog/2024/daily_coding/20251121235405115.png
  lqip: data:image/webp;base64,UklGRpoAAABXRUJQVlA4WAoAAAAQAAAADwAABwAAQUxQSDIAAAARL0AmbZurmr57yyIiqE8oiG0bejIYEQTgqiDA9vqnsUSI6H+oAERp2HZ65qP/VIAWAFZQOCBCAAAA8AEAnQEqEAAIAAVAfCWkAALp8sF8rgRgAP7o9FDvMCkMde9PK7euH5M1m6VWoDXf2FkP3BqV0ZYbO6NA/VFIAAAA
---

## 题目

**描述：**

给定一个表示 **大整数** 的整数数组 `digits`，其中 `digits[i]` 是整数的第 `i` 位数字。这些数字按从左到右，从最高位到最低位排列。这个大整数不包含任何前导 0。

将大整数加 1，并返回结果的数字数组。

**示例 1:**

- **输入:** `digits = [1,2,3]`
- **输出:** `[1,2,4]`
- **解释:** 输入数组表示数字 123。加 1 后得到 123 + 1 = 124。因此，结果应该是 `[1,2,4]`。

**示例 2:**

- **输入:** `digits = [4,3,2,1]`
- **输出:** `[4,3,2,2]`
- **解释:** 输入数组表示数字 4321。加 1 后得到 4321 + 1 = 4322。因此，结果应该是 `[4,3,2,2]`。

**示例 3:**

- **输入:** `digits = [9]`
- **输出:** `[1,0]`
- **解释:** 输入数组表示数字 9。加 1 后得到 9 + 1 = 10。因此，结果应该是 `[1,0]`。

**提示:**

- `1 <= digits.length <= 100`
- `0 <= digits[i] <= 9`
- `digits` 不包含任何前导 0。

## 题解

### 解法：倒序遍历 + 数学进位 (Reverse Iteration)

**思路：**

我们要模拟人工进行加法运算的过程，即从整数的**个位**（数组的末尾）开始处理。

1.  **倒序遍历**：从数组的最后一个元素开始向前遍历。
2.  **判断进位**：

    - 如果当前位数字 **小于 9**：直接将该位数字加 1，因为没有产生进位，整个加法过程结束，直接返回当前数组。
    - 如果当前位数字 **等于 9**：该位加 1 后变成 10，需要进位。我们将当前位变为 `0`，然后继续循环处理前一位。

3.  **特殊情况（全为 9）**：

    - 如果我们遍历完了整个数组（例如 `[9, 9, 9]`），说明所有位都产生了进位，此时数组变成了 `[0, 0, 0]`。
    - 这意味着我们需要扩展数组长度。结果必然是 `1` 后面跟着 `n` 个 `0`（例如 `1000`）。
    - 我们只需要创建一个长度为 `n + 1` 的新数组，并将第 0 位设为 `1` 即可（Java 中 `int` 数组默认值就是 0，所以后续位置不需要手动填 0）。

**复杂度分析：**

- **时间复杂度：** $O(n)$，其中 $n$ 是数组的长度。

  - 最好的情况（末尾不是 9）：$O(1)$。
  - 最坏的情况（全为 9）：$O(n)$。

- **空间复杂度：** $O(1)$，除了返回值可能需要的额外空间外，我们是在原数组上进行修改（In-place）。

**代码片段：**

```java
public int[] plusOne(int[] digits) {
    int n = digits.length;
    // 从后往前遍历
    for (int i = n - 1; i >= 0; i--) {
        // 如果当前位不是 9，直接加 1 返回
        if (digits[i] < 9) {
            digits[i]++;
            return digits;
        }
        // 如果是 9，变成 0，继续下一轮循环（处理进位）
        digits[i] = 0;
    }

    // 如果跑到了这里，说明数组全是 9 (如 999 -> 000)
    // 需要进位扩展数组 (变成 1000)
    int[] newNumber = new int[n + 1];
    newNumber[0] = 1;

    return newNumber;
}
```

### 完整代码

```java
import java.util.Arrays;

public class Main {

    /**
     * 66. 加一
     */
    public static int[] plusOne(int[] digits) {
        int n = digits.length;

        // 1. 从数组末尾开始向前遍历
        for (int i = n - 1; i >= 0; i--) {
            // 情况 A: 当前数字小于 9
            // 直接加 1，不会产生进位，任务结束，直接返回
            if (digits[i] < 9) {
                digits[i]++;
                return digits;
            }

            // 情况 B: 当前数字等于 9
            // 加 1 后变成 10，当前位变为 0，进位留给下一次循环处理
            digits[i] = 0;
        }

        // 2. 处理特殊情况：数组所有位都是 9
        // 循环结束后没有返回，说明如 [9,9] 变成了 [0,0]
        // 我们需要新建一个长度 +1 的数组，首位为 1，其余默认为 0
        int[] newNumber = new int[n + 1];
        newNumber[0] = 1;

        return newNumber;
    }

    public static void main(String[] args) {
        // --- 示例 1 ---
        int[] digits1 = {1, 2, 3};
        System.out.println("示例 1 输入: " + Arrays.toString(digits1));
        int[] res1 = plusOne(digits1);
        System.out.println("示例 1 输出: " + Arrays.toString(res1));
        // 解释: 123 + 1 = 124
        System.out.println("-----------------------------");

        // --- 示例 2 ---
        int[] digits2 = {4, 3, 2, 1};
        System.out.println("示例 2 输入: " + Arrays.toString(digits2));
        int[] res2 = plusOne(digits2);
        System.out.println("示例 2 输出: " + Arrays.toString(res2));
        // 解释: 4321 + 1 = 4322
        System.out.println("-----------------------------");

        // --- 示例 3 (进位扩展) ---
        int[] digits3 = {9};
        System.out.println("示例 3 输入: " + Arrays.toString(digits3));
        int[] res3 = plusOne(digits3);
        System.out.println("示例 3 输出: " + Arrays.toString(res3));
        // 解释: 9 + 1 = 10
        System.out.println("-----------------------------");

        // --- 额外示例 (连续进位) ---
        int[] digits4 = {1, 9, 9};
        System.out.println("额外示例 输入: " + Arrays.toString(digits4));
        int[] res4 = plusOne(digits4);
        System.out.println("额外示例 输出: " + Arrays.toString(res4));
        // 解释: 199 + 1 = 200
    }
}
```
