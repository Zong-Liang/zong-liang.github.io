---
title: 125. 验证回文串
date: 2024-04-14 06:00:00 +0800
categories: [Daily Coding, Top Interview 150, 双指针]
tags: [双指针]
toc: true
math: true
pin: false
render_with_liquid: false
image:
  path: https://cdn.jsdelivr.net/gh/Zong-Liang/blog_images/blog/2024/daily_coding/20251121223658589.png
  lqip: data:image/webp;base64,UklGRpoAAABXRUJQVlA4WAoAAAAQAAAADwAABwAAQUxQSDIAAAARL0AmbZurmr57yyIiqE8oiG0bejIYEQTgqiDA9vqnsUSI6H+oAERp2HZ65qP/VIAWAFZQOCBCAAAA8AEAnQEqEAAIAAVAfCWkAALp8sF8rgRgAP7o9FDvMCkMde9PK7euH5M1m6VWoDXf2FkP3BqV0ZYbO6NA/VFIAAAA
---

## 题目

**描述：**

如果在将所有大写字符转换为小写字符、并移除所有非字母数字字符之后，短语正着读和反着读都一样。则可以认为该短语是一个 **回文串** 。

字母和数字都属于字母数字字符。

给你一个字符串 `s`，如果它是 **回文串** ，返回 `true` ；否则，返回 `false` 。

**示例 1:**

- **输入:** `s = "A man, a plan, a canal: Panama"`
- **输出:** `true`
- **解释:** `"amanaplanacanalpanama"` 是回文串。

**示例 2:**

- **输入:** `s = "race a car"`
- **输出:** `false`
- **解释:** `"raceacar"` 不是回文串。

**示例 3:**

- **输入:** `s = " "`
- **输出:** `true`
- **解释:** 在移除除非字母数字字符之后，`s` 是一个空字符串 `""` 。由于空字符串正着反着读都一样，所以是回文串。

**提示:**

- `1 <= s.length <= 2 * 10^5`
- `s` 仅由可打印的 ASCII 字符组成

## 题解

### 解法：双指针法

**思路：**

最直接的方法是先对字符串进行预处理（去除非字母数字字符并转为小写），然后反转字符串进行比较。但这样需要额外的 $O(n)$ 空间。

更优的方法是利用 **双指针** 在原字符串上直接进行判断，从而将空间复杂度降低到 $O(1)$。

1.  定义两个指针，`left` 指向字符串头部，`right` 指向字符串尾部。
2.  当 `left < right` 时，执行循环：

    - **左指针右移**：如果 `s.charAt(left)` 不是字母或数字，`left` 向后移动，跳过该字符。
    - **右指针左移**：如果 `s.charAt(right)` 不是字母或数字，`right` 向前移动，跳过该字符。
    - **比较**：当两个指针都停在有效的字母或数字上时，比较这两个字符（统一转为小写）。如果不相等，说明不是回文串，返回 `false`。
    - 如果相等，`left` 和 `right` 同时向中间移动一步，继续下一轮比较。

3.  如果循环结束都没有返回 `false`，说明是回文串，返回 `true`。

**复杂度分析：**

- **时间复杂度：** $O(n)$，其中 $n$ 是字符串的长度。我们最多遍历字符串一次。
- **空间复杂度：** $O(1)$，直接在原字符串上操作，只需要常数级别的额外空间用于存储指针。

**代码片段：**

```java
public boolean isPalindrome(String s) {
    if (s == null || s.length() == 0) return true;

    int left = 0;
    int right = s.length() - 1;

    while (left < right) {
        // 将 left 移动到下一个字母或数字字符
        while (left < right && !Character.isLetterOrDigit(s.charAt(left))) {
            left++;
        }
        // 将 right 移动到前一个字母或数字字符
        while (left < right && !Character.isLetterOrDigit(s.charAt(right))) {
            right--;
        }

        // 比较两个字符（忽略大小写）
        if (left < right) {
            if (Character.toLowerCase(s.charAt(left)) != Character.toLowerCase(s.charAt(right))) {
                return false;
            }
            left++;
            right--;
        }
    }
    return true;
}
```

---

### 完整代码

```java
public class Main {

    // 核心算法实现：双指针法
    public static boolean isPalindrome(String s) {
        if (s == null || s.isEmpty()) {
            return true;
        }

        int left = 0;
        int right = s.length() - 1;

        while (left < right) {
            // 1. left 指针跳过非字母数字字符
            while (left < right && !Character.isLetterOrDigit(s.charAt(left))) {
                left++;
            }
            // 2. right 指针跳过非字母数字字符
            while (left < right && !Character.isLetterOrDigit(s.charAt(right))) {
                right--;
            }

            // 3. 比较字符
            if (left < right) {
                // 统一转换为小写进行比较
                if (Character.toLowerCase(s.charAt(left)) != Character.toLowerCase(s.charAt(right))) {
                    return false;
                }
                left++;
                right--;
            }
        }
        return true;
    }

    public static void main(String[] args) {
        // --- 示例 1 ---
        String s1 = "A man, a plan, a canal: Panama";
        System.out.println("示例 1 输入: s = \"" + s1 + "\"");
        System.out.println("示例 1 输出: " + isPalindrome(s1));
        System.out.println("-----------------------------");

        // --- 示例 2 ---
        String s2 = "race a car";
        System.out.println("示例 2 输入: s = \"" + s2 + "\"");
        System.out.println("示例 2 输出: " + isPalindrome(s2));
        System.out.println("-----------------------------");

        // --- 示例 3 ---
        String s3 = " ";
        System.out.println("示例 3 输入: s = \"" + s3 + "\"");
        System.out.println("示例 3 输出: " + isPalindrome(s3));
        // 解释: 移除非字母数字字符后为空字符串，空字符串也是回文
    }
}
```
