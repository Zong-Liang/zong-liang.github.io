---
title: 137. 只出现一次的数字II
date: 2024-11-04 06:00:00 +0800
categories: [Daily Coding, Top Interview 150, 位运算]
tags: [位运算]
toc: true
math: true
pin: false
render_with_liquid: false
image:
  path: https://cdn.jsdelivr.net/gh/Zong-Liang/blog_images/blog/2024/daily_coding/20251121235141146.png
  lqip: data:image/webp;base64,UklGRpoAAABXRUJQVlA4WAoAAAAQAAAADwAABwAAQUxQSDIAAAARL0AmbZurmr57yyIiqE8oiG0bejIYEQTgqiDA9vqnsUSI6H+oAERp2HZ65qP/VIAWAFZQOCBCAAAA8AEAnQEqEAAIAAVAfCWkAALp8sF8rgRgAP7o9FDvMCkMde9PK7euH5M1m6VWoDXf2FkP3BqV0ZYbO6NA/VFIAAAA
---

## 题目：137. 只出现一次的数字 II

给你一个整数数组 `nums`，除某个元素仅出现 **一次** 外，其余每个元素都恰好出现 **三次**。请你找出并返回那个只出现了一次的元素。

你必须设计并实现线性时间复杂度的算法且使用常数级空间来解决此问题。

**示例 1:**

- **输入:** `nums = [2,2,3,2]`
- **输出:** 3

**示例 2:**

- **输入:** `nums = [0,1,0,1,0,1,99]`
- **输出:** 99

**提示:**

- `1 <= nums.length <= 3 * 10^4`
- `-2^31 <= nums[i] <= 2^31 - 1`
- `nums` 中，除某个元素仅出现 **一次** 外，其余每个元素都恰好出现 **三次**

## Java 代码

**算法思路：(位运算)**

为了满足线性的时间复杂度和常数的空间复杂度，我们不能使用哈希表或排序。一个巧妙的解决方案是利用位运算。

我们可以考虑整数的 32 个二进制位。对于数组中所有的数字，我们统计每个二进制位上 `1` 出现的总次数。

- 如果一个数字出现了三次，那么它在二进制的每一位上（无论是 `0` 还是 `1`）的贡献也会被计算三次。
- 因此，对于那些出现了三次的数字，它们在任何一个二进制位上 `1` 的总数都必然是 3 的倍数。
- 而那个只出现一次的数字，它在某一位上的 `1` 只会贡献一次。

所以，如果我们把所有数字在第 `i` 位上的 `1` 的个数加起来，然后对 3 取模，结果就是那个只出现一次的数字在第 `i` 位上的值（0 或 1）。

通过遍历 32 个位，我们可以重建出这个只出现一次的数字。

```java
import java.util.Arrays;


public class Main {

    /**
     * 找出数组中只出现一次的元素。
     *
     * @param nums 整数数组，其中一个元素出现一次，其余出现三次。
     * @return 只出现一次的那个元素。
     */
    public static int singleNumber(int[] nums) {
        int result = 0;
        // Java 中 int 是 32 位
        for (int i = 0; i < 32; i++) {
            int total = 0;
            // 计算所有数字在第 i 位上 1 的总数
            for (int num : nums) {
                // (num >> i) & 1 取出 num 的第 i 位
                total += (num >> i) & 1;
            }

            // 如果总数不是 3 的倍数，说明那个只出现一次的数字在这一位上是 1
            if (total % 3 != 0) {
                // (1 << i) 将 1 左移 i 位，设置 result 的第 i 位
                result |= (1 << i);
            }
        }
        return result;
    }

    /**
     * 主函数，包含题目给出的测试用例。
     * @param args 命令行参数（未使用）。
     */
    public static void main(String[] args) {
        System.out.println("--- 示例 1 ---");
        int[] nums1 = {2, 2, 3, 2};
        System.out.println("输入: nums = " + Arrays.toString(nums1));
        int result1 = singleNumber(nums1);
        System.out.println("输出: " + result1); // 预期输出: 3
        System.out.println();

        System.out.println("--- 示例 2 ---");
        int[] nums2 = {0, 1, 0, 1, 0, 1, 99};
        System.out.println("输入: nums = " + Arrays.toString(nums2));
        int result2 = singleNumber(nums2);
        System.out.println("输出: " + result2); // 预期输出: 99
        System.out.println();
    }
}
```
