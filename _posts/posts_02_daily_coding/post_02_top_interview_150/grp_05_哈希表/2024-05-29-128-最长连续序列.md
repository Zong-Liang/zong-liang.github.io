---
title: 128. 最长连续序列
date: 2024-05-29 06:00:00 +0800
categories: [Daily Coding, Top Interview 150, 哈希表]
tags: [哈希表]
toc: true
math: true
pin: false
render_with_liquid: false
image:
  path: https://cdn.jsdelivr.net/gh/Zong-Liang/blog_images/blog/2024/daily_coding/20251121225545067.png
  lqip: data:image/webp;base64,UklGRpoAAABXRUJQVlA4WAoAAAAQAAAADwAABwAAQUxQSDIAAAARL0AmbZurmr57yyIiqE8oiG0bejIYEQTgqiDA9vqnsUSI6H+oAERp2HZ65qP/VIAWAFZQOCBCAAAA8AEAnQEqEAAIAAVAfCWkAALp8sF8rgRgAP7o9FDvMCkMde9PK7euH5M1m6VWoDXf2FkP3BqV0ZYbO6NA/VFIAAAA
---


## 题目：128. 最长连续序列

**描述**

给定一个未排序的整数数组 `nums` ，找出数字连续的最长序列（不要求序列元素在原数组中连续）的长度。

请你设计并实现时间复杂度为 `O(n)` 的算法解决此问题。

**示例 1:**

- **输入:** `nums = [100,4,200,1,3,2]`
- **输出:** 4
- **解释:** 最长数字连续序列是 `[1, 2, 3, 4]`。它的长度为 4。

**示例 2:**

- **输入:** `nums = [0,3,7,2,5,8,4,6,0,1]`
- **输出:** 9

**示例 3:**

- **输入:** `nums = [1,0,1,2]`
- **输出:** 3

**提示:**

- `0 <= nums.length <= 10^5`
- `-10^9 <= nums[i] <= 10^9`


## Java 代码

```java
import java.util.Arrays;
import java.util.HashSet;
import java.util.Set;

public class Main {

    /**
     * 找出未排序整数数组中最长连续序列的长度。
     * 算法时间复杂度要求为 O(n)。
     *
     * @param nums 未排序的整数数组
     * @return 最长连续序列的长度
     */
    public static int longestConsecutive(int[] nums) {
        if (nums == null || nums.length == 0) {
            return 0;
        }

        // 1. 使用 HashSet 存储所有数字，以便 O(1) 的时间复杂度进行查找
        Set<Integer> numSet = new HashSet<>();
        for (int num : nums) {
            numSet.add(num);
        }

        int longestStreak = 0;

        // 2. 遍历 HashSet 中的每个数字
        for (int num : numSet) {
            // 3. 关键优化：只对连续序列的第一个数字开始计算
            // 如果 num-1 存在，说明 num 不是序列的起点，跳过
            if (!numSet.contains(num - 1)) {
                int currentNum = num;
                int currentStreak = 1;

                // 4. 从序列起点开始，向后查找连续的数字
                while (numSet.contains(currentNum + 1)) {
                    currentNum += 1;
                    currentStreak += 1;
                }

                // 5. 更新最长序列的长度
                longestStreak = Math.max(longestStreak, currentStreak);
            }
        }

        return longestStreak;
    }

    public static void main(String[] args) {
        // 示例 1
        int[] nums1 = {100, 4, 200, 1, 3, 2};
        System.out.println("输入: " + Arrays.toString(nums1));
        System.out.println("输出: " + longestConsecutive(nums1)); // 预期: 4
        System.out.println("---");

        // 示例 2
        int[] nums2 = {0, 3, 7, 2, 5, 8, 4, 6, 0, 1};
        System.out.println("输入: " + Arrays.toString(nums2));
        System.out.println("输出: " + longestConsecutive(nums2)); // 预期: 9
        System.out.println("---");

        // 示例 3
        int[] nums3 = {1, 0, 1, 2};
        System.out.println("输入: " + Arrays.toString(nums3));
        System.out.println("输出: " + longestConsecutive(nums3)); // 预期: 3
        System.out.println("---");
    }
}
```
