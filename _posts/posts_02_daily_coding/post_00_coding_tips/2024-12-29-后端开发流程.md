---
title: 后端开发流程
date: 2024-12-29 06:00:00 +0800
categories: [Daily Coding, Coding Tips, 后端开发流程]
tags: [后端开发流程]
toc: true
math: true
pin: false
render_with_liquid: false
image:
  path: https://cdn.jsdelivr.net/gh/Zong-Liang/blog_images/blog/2024/daily_coding/20251130152946198.png
  lqip: data:image/webp;base64,UklGRpoAAABXRUJQVlA4WAoAAAAQAAAADwAABwAAQUxQSDIAAAARL0AmbZurmr57yyIiqE8oiG0bejIYEQTgqiDA9vqnsUSI6H+oAERp2HZ65qP/VIAWAFZQOCBCAAAA8AEAnQEqEAAIAAVAfCWkAALp8sF8rgRgAP7o9FDvMCkMde9PK7euH5M1m6VWoDXf2FkP3BqV0ZYbO6NA/VFIAAAA
---

很多人认为后端开发就是“写接口”和“CRUD（增删改查）”，但实际上，从需求到上线，这其实是一项严密的系统工程。

## 第一阶段：需求分析与设计

代码还没写，成败已定了一半。这个阶段核心是**把业务语言翻译成技术语言**。

1.  **需求评审 (Requirement Review)**

    - **参与者**：产品经理 (PM)、前端、后端、测试。
    - **后端职责**：确认需求逻辑是否闭环、边界情况（Corner Case）处理、评估技术可行性。
    - **产出**：敲定 PRD（产品需求文档）。

2.  **技术方案设计 (Technical Design)**

    - **概要设计**：确定架构模式（单体还是微服务？），技术选型（用 MySQL 还是 Mongo？需不需要用 MQ 解耦？）。
    - **详细设计**：

      - **ER 图/库表设计**：这是 Java 后端的灵魂。遵循三范式但适当反范式（冗余字段换性能）。定义字段类型（如金额用 `BigDecimal` 存还是 `Long` 分，时间用 `LocalDateTime`）。
      - **接口定义 (API Design)**：定义 URL、HTTP Method、入参（DTO）、出参（VO）。通常使用 **Swagger/YApi/Apifox** 先行定义，方便前后端并行开发。
      - **时序图/流程图**：对于复杂的业务（如订单支付状态流转），必须画图。

## 第二阶段：环境搭建与规范制定

1.  **脚手架搭建 (Scaffolding)**

    - **基础框架**：Spring Boot 3.x / Spring Cloud Alibaba。
    - **依赖管理**：Maven 或 Gradle。定义父工程（Parent POM）锁定版本，避免依赖冲突（Jar Hell）。
    - **多环境配置**：划分 `dev` (开发), `test` (测试), `prod` (生产) 配置文件。

2.  **代码规范与分层 (Code Standard)**

    - **规范**：强制引入《阿里巴巴 Java 开发手册》插件，配置 CheckStyle 或 SonarLint。
    - **工程分层**：

      - `Web/Controller`：参数校验、统一响应封装。
      - `Service`：核心业务逻辑、事务控制 (`@Transactional`)。
      - `Manager` (可选)：通用业务处理、第三方接口封装。
      - `DAO/Mapper`：数据库交互 (MyBatis/JPA)。
      - `Model`：严格区分 DO (数据库实体), DTO (传输对象), VO (视图对象)。

3.  **Git 工作流 (Git Workflow)**

    - 确立分支策略（如 Gitflow）：`master` (生产), `release` (预发), `develop` (开发), `feature/*` (功能分支), `hotfix/*` (紧急修复)。

## 第三阶段：核心编码与实现

这是最耗时的阶段，也是体现“码力”的地方。

1.  **数据库层开发**

    - 使用 **MyBatis-Plus** 或 **JPA** 生成基础代码。
    - **关键点**：索引优化、SQL 性能检查、防止 SQL 注入。

2.  **业务逻辑开发 (Service Layer)**

    - **对象转换**：使用 **MapStruct** 或 **BeanUtils** 进行 DTO -> DO -> VO 的转换，拒绝在代码里写几十行 `set/get`。
    - **异常处理**：定义**全局异常处理器 (GlobalExceptionHandler)**，将 `Try-Catch` 逻辑统一捕获，返回标准化的错误码（如 `code: 50001, msg: "余额不足"`）。
    - **日志记录**：使用 **SLF4J + Logback/Log4j2**。关键路径打 Log，切记不要打在循环里，注意脱敏（手机号、密码）。

3.  **分布式/高并发场景处理 (Advanced)**

    - **缓存**：引入 **Redis** 缓存热点数据，处理缓存穿透/击穿/雪崩问题。
    - **消息队列**：使用 **RocketMQ/Kafka** 进行异步解耦（如注册成功发短信）、流量削峰。
    - **分布式锁**：使用 Redisson 处理并发资源抢占（如秒杀扣库存）。
    - **幂等性设计**：防止接口重试导致数据重复（利用数据库唯一索引或 Redis Token）。

4.  **单元测试 (Unit Testing)**

    - 这区分了普通程序员和专家。使用 **JUnit 5 + Mockito**。
    - 核心业务逻辑覆盖率要求（如 >60%）。不依赖真实数据库和网络。

## 第四阶段：联调与测试

1.  **本地自测**

    - 开发者使用 Postman 或 IntelliJ HTTP Client 自测接口。
    - 确保 Happy Path (正常流程) 和 Exception Path (异常流程) 都通过。

2.  **前后端联调**

    - 后端部署到 Dev 环境，对着 API 文档和前端对接。
    - **CORS**：解决跨域问题。

3.  **提测与 Bug 修复**

    - 代码合并到 `test` 分支，部署测试环境。
    - QA 进行功能测试、回归测试。
    - **性能测试**：使用 **JMeter** 压测核心接口，关注 TPS、响应时间、CPU/内存使用率。如有问题，需进行 JVM 调优或 SQL 优化。

4.  **Code Review (代码评审)**

    - 团队坐在一起看代码。关注点：命名是否规范、是否有并发安全隐患、是否过度设计、是否有未处理的 TODO。

## 第五阶段：CI/CD 与 部署

现在的后端开发离不开 DevOps。

1.  **容器化**

    - 编写 `Dockerfile`，将 Java 应用打包成 Docker 镜像（Image）。
    - JDK 选择：推荐使用轻量级的 Alpine Linux 或 Eclipse Temurin JDK。

2.  **CI/CD 流水线**

    - 使用 **Jenkins**、**GitLab CI** 或 **GitHub Actions**。
    - **流程**：Git Push -> 编译 (Maven Build) -> 单元测试 -> 静态扫描 (SonarQube) -> 构建镜像 -> 推送镜像仓库 (Harbor) -> 部署到 K8s/服务器。

3.  **灰度发布/蓝绿部署**

    - 对于核心系统，不能一次性全量上线。先上几台机器（金丝雀发布），观察无误后再全量。

## 第六阶段：运维与监控

代码上线不是结束，而是开始。

1.  **可观测性 (Observability)**

    - **日志中心**：接入 **ELK (Elasticsearch, Logstash, Kibana)** 或 Loki，集中查询日志。
    - **链路追踪**：接入 **SkyWalking** 或 Zipkin，追踪一个请求经过了哪些微服务，哪里慢了。
    - **指标监控**：使用 **Prometheus + Grafana** 监控 JVM (Heap, GC, Threads)、Tomcat 连接数、QPS 等。

2.  **生产问题排查**

    - **告警**：配置钉钉/邮件告警（如 CPU > 80%，接口错误率 > 5%）。
    - **线上诊断**：当服务不可用时，使用 **Arthas** 进行在线诊断（查看线程堆栈、热更新代码、反编译查看源码）。

## 总结：

在这个流程中，你要注重的不仅仅是**功能实现**，更是：

1.  **鲁棒性**：服务挂了怎么办？网络抖动怎么办？（熔断、降级、重试）。
2.  **扩展性**：需求变了，代码好不好改？（设计模式、开闭原则）。
3.  **安全性**：SQL 注入、XSS、敏感数据加密、权限控制（Spring Security/Satoken）。
